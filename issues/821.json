{
  "type": "issue",
  "issue": {
    "id": 2315751386,
    "node_id": "I_kwDOEEET9c6KB4_a",
    "url": "https://api.github.com/repos/bitcoin-core/gui/issues/821",
    "repository_url": "https://api.github.com/repos/bitcoin-core/gui",
    "labels_url": "https://api.github.com/repos/bitcoin-core/gui/issues/821/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin-core/gui/issues/821/comments",
    "events_url": "https://api.github.com/repos/bitcoin-core/gui/issues/821/events",
    "html_url": "https://github.com/bitcoin-core/gui/issues/821",
    "number": 821,
    "state": "open",
    "state_reason": null,
    "title": "Welcome screen uses GiB values as GB, risking running out of space",
    "body": "### Is there an existing issue for this?\n\n- [X] I have searched the existing issues\n\n### Current behaviour\n\nThe welcome screen correctly displays \"55 GB of space available\" while my system has 54322808 bytes available.\r\n\r\nBut it incorrectly says \"... 12 GB of data will be stored in this directory\" or  \"610 GB of data\" if I uncheck the 2GB pruning. The values it is adding and comparing do not have the same unit. One is a GUI prune setting and/or space available in GB, the other is actually GiB: https://github.com/bitcoin/bitcoin/blob/master/doc/release-process.md#how-to-calculate-m_assumed_blockchain_size-and-m_assumed_chain_state_size\r\n\r\nSince the \"how to calculate m_assumed ... size\" instructions add a 5-10% buffer, what we display when only a 5-7% buffer is added to the values used in our GUI's space calculations will be too small and may lead to the user running out of space without being warned by the red text `XXX GB of space available (of XXX GB needed)`.\n\n### Expected behaviour\n\nThe Welcome dialog should either use all GB or all GiB for its math. That way it never underestimates the space needed.\r\nConverting the `assumed_chain_state` and `assumed_blockchain_size` to GB is a matter of multiplying by 1.073741824 and rounding up to the nearest GB.\r\n\r\nThat would update the values I was shown to: 13 GB and 655 GB respectively. You can see the gap between GB & GiB has gotten too massive to ignore, especially when estimating `-prune=0` space needed.\r\n\r\nAlternatively the units could be switched to GiB and my space available reported as 52 GiB and my prune setting bumped up to be 2 GiB (making it easier to predict what the GUI will show because the -prune command takes MiB).\r\n\r\nI believe GB was used as it is the more familiar unit and matches what the OS and storage manufacturers tend to display so lets apply the first solution. Or update the https://github.com/bitcoin/bitcoin/blob/master/doc/release-process.md#how-to-calculate-assumed-blockchain-and-chain-state-size \r\ndoc to require using a 13-19% buffer to allow for the previous 5-10% when they are misused as GB values despite being calculated as GiB.\n\n### Steps to reproduce\n\n`bitcoin-qt -choosedatadir` notice the addition and subtraction of values that have different units as per our docs.\n\n### Relevant log output\n\n_No response_\n\n### How did you obtain Bitcoin Core\n\nPre-built binaries\n\n### What version of Bitcoin Core are you using?\n\nmaster / 27.0\n\n### Operating system and version\n\nDebian 12\n\n### Machine specifications\n\n_No response_",
    "user": {
      "login": "BenWestgate",
      "id": 73506583,
      "node_id": "MDQ6VXNlcjczNTA2NTgz",
      "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/BenWestgate",
      "html_url": "https://github.com/BenWestgate",
      "followers_url": "https://api.github.com/users/BenWestgate/followers",
      "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
      "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
      "repos_url": "https://api.github.com/users/BenWestgate/repos",
      "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [],
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "locked": false,
    "comments": 2,
    "created_at": "2024-05-24T16:03:49Z",
    "updated_at": "2024-07-15T09:55:22Z"
  },
  "events": [
    {
      "event": "commented",
      "id": 2130014340,
      "node_id": "IC_kwDOEEET9c5-9XCE",
      "url": "https://api.github.com/repos/bitcoin-core/gui/issues/comments/2130014340",
      "actor": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-05-24T17:09:35Z",
      "updated_at": "2024-05-24T17:09:35Z",
      "author_association": "CONTRIBUTOR",
      "body": "On further analysis, the code comments in chainparams.h also think these values should be GB so I understand the origin of the gui error. It seems the release-process.md is the odd one out of the 3. This issue can be closed if the doc: PR below is ACK'd.\r\nhttps://github.com/bitcoin/bitcoin/pull/30171",
      "user": {
        "login": "BenWestgate",
        "id": 73506583,
        "node_id": "MDQ6VXNlcjczNTA2NTgz",
        "avatar_url": "https://avatars.githubusercontent.com/u/73506583?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/BenWestgate",
        "html_url": "https://github.com/BenWestgate",
        "followers_url": "https://api.github.com/users/BenWestgate/followers",
        "following_url": "https://api.github.com/users/BenWestgate/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/BenWestgate/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/BenWestgate/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/BenWestgate/subscriptions",
        "organizations_url": "https://api.github.com/users/BenWestgate/orgs",
        "repos_url": "https://api.github.com/users/BenWestgate/repos",
        "events_url": "https://api.github.com/users/BenWestgate/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/BenWestgate/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/gui/issues/821#issuecomment-2130014340",
      "issue_url": "https://api.github.com/repos/bitcoin-core/gui/issues/821"
    },
    {
      "event": "commented",
      "id": 2228117027,
      "node_id": "IC_kwDOEEET9c6Ezl4j",
      "url": "https://api.github.com/repos/bitcoin-core/gui/issues/comments/2228117027",
      "actor": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2024-07-15T09:55:21Z",
      "updated_at": "2024-07-15T09:55:21Z",
      "author_association": "MEMBER",
      "body": "Also see https://github.com/bitcoin/bitcoin/pull/29678.",
      "user": {
        "login": "hebasto",
        "id": 32963518,
        "node_id": "MDQ6VXNlcjMyOTYzNTE4",
        "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hebasto",
        "html_url": "https://github.com/hebasto",
        "followers_url": "https://api.github.com/users/hebasto/followers",
        "following_url": "https://api.github.com/users/hebasto/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hebasto/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hebasto/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
        "organizations_url": "https://api.github.com/users/hebasto/orgs",
        "repos_url": "https://api.github.com/users/hebasto/repos",
        "events_url": "https://api.github.com/users/hebasto/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hebasto/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/gui/issues/821#issuecomment-2228117027",
      "issue_url": "https://api.github.com/repos/bitcoin-core/gui/issues/821"
    }
  ]
}