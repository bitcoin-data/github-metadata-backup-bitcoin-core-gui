{
  "type": "issue",
  "issue": {
    "id": 1937768251,
    "node_id": "I_kwDOEEET9c5zf_87",
    "url": "https://api.github.com/repos/bitcoin-core/gui/issues/768",
    "repository_url": "https://api.github.com/repos/bitcoin-core/gui",
    "labels_url": "https://api.github.com/repos/bitcoin-core/gui/issues/768/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin-core/gui/issues/768/comments",
    "events_url": "https://api.github.com/repos/bitcoin-core/gui/issues/768/events",
    "html_url": "https://github.com/bitcoin-core/gui/issues/768",
    "number": 768,
    "state": "open",
    "state_reason": null,
    "title": "High CPU load when network traffic page left open",
    "body": "### Is there an existing issue for this?\n\n- [X] I have searched the existing issues\n\n### Current behaviour\n\nPossibly related to https://github.com/bitcoin-core/gui/issues/466\r\n\r\nRunning `Bitcoin Core version v25.99.0-04265ba9378e`\r\n\r\nWhen running `bitcoin-qt` with an additional `network traffic` window open, after some time CPU usage on a single core starts to thrash between 60-100%. The CPU thrashing will (immediately) drop when the `network traffic` window is closed.\n\n### Expected behaviour\n\nViewing the `network traffic` page should not use 100% CPU or cause thrashing.\n\n### Steps to reproduce\n\n## steps\r\n\r\n* Run `bitcoin-qt`, open `network traffic` and wait some time? I think the graph needs to include a wide range of datapoints for this (rendering?) bug to occur (see below screenshots).\r\n\r\n## actions\r\n\r\nI ran `perf` for 30 seconds on `bitcoin-qt` while CPU was thrashing, but it seemed to only [show a lot of time spent in `libQT5Gui.so`](https://tmp.256k1.dev/23_10_bitcoin_qt_cpu.svg),  which doesn't seem particularly helpful.  \r\n\r\nI noticed that the CPU spikes seem to only be present when the graph is well-populated with many variously-valued data points, like this:\r\n\r\n![image](https://github.com/bitcoin-core/gui/assets/6606587/97b752af-89dc-42e9-83ff-08302ec08c51)\r\n\r\nHowever CPU usage drops if there is a large spike in network activity, which causes a low level of datapoint variation (plus one large spike), like this:\r\n\r\n![image](https://github.com/bitcoin-core/gui/assets/6606587/20b0a757-2f8c-4887-a89f-b2f390ebcce2)\n\n### Relevant log output\n\nNothing of interest was present in the logs.\n\n### How did you obtain Bitcoin Core\n\nCompiled from source\n\n### What version of Bitcoin Core are you using?\n\nv25.99.0-04265ba9378e\n\n### Operating system and version\n\nUbuntu 23.04\n\n### Machine specifications\n\nOS: Ubuntu 23.04 x86_64\r\nCPU: 11th Gen Intel i7-11700K (16) @ 3.800GHz\r\nGPU: NVIDIA GeForce RTX 3060 Ti\r\nMemory: 64162MiB\r\nHDD: Samsung SSD 990 PRO 2TB\r\nMB: Z590 AORUS ELITE AX\r\nKernel: 6.2.0-33-generic\r\nResolution: 3840x2160\r\nWM: i3\r\nTerminal: tmux\r\nShell: fish 3.6.1",
    "user": {
      "login": "willcl-ark",
      "id": 6606587,
      "node_id": "MDQ6VXNlcjY2MDY1ODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/willcl-ark",
      "html_url": "https://github.com/willcl-ark",
      "followers_url": "https://api.github.com/users/willcl-ark/followers",
      "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
      "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
      "repos_url": "https://api.github.com/users/willcl-ark/repos",
      "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [],
    "assignees": [],
    "author_association": "CONTRIBUTOR",
    "locked": false,
    "comments": 5,
    "created_at": "2023-10-11T13:20:07Z",
    "updated_at": "2023-10-24T13:01:01Z"
  },
  "events": [
    {
      "event": "commented",
      "id": 1759384920,
      "node_id": "IC_kwDOEEET9c5o3hVY",
      "url": "https://api.github.com/repos/bitcoin-core/gui/issues/comments/1759384920",
      "actor": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-12T10:55:53Z",
      "updated_at": "2023-10-12T10:55:53Z",
      "author_association": "CONTRIBUTOR",
      "body": "This graph \"shape\" also exhibited the same behaviour, so it seems reproducible (for me).\r\n\r\n![image](https://github.com/bitcoin-core/gui/assets/6606587/630740b6-7f7a-4cd9-937d-b3982d7fcb33)\r\n",
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/gui/issues/768#issuecomment-1759384920",
      "issue_url": "https://api.github.com/repos/bitcoin-core/gui/issues/768"
    },
    {
      "event": "commented",
      "id": 1759877601,
      "node_id": "IC_kwDOEEET9c5o5Znh",
      "url": "https://api.github.com/repos/bitcoin-core/gui/issues/comments/1759877601",
      "actor": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-12T15:41:52Z",
      "updated_at": "2023-10-12T15:41:52Z",
      "author_association": "MEMBER",
      "body": "Is this only an issue with master (regression) or also a problem if you run 25.0 or 25.1rc1?",
      "user": {
        "login": "fanquake",
        "id": 863730,
        "node_id": "MDQ6VXNlcjg2MzczMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fanquake",
        "html_url": "https://github.com/fanquake",
        "followers_url": "https://api.github.com/users/fanquake/followers",
        "following_url": "https://api.github.com/users/fanquake/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/fanquake/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/fanquake/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
        "organizations_url": "https://api.github.com/users/fanquake/orgs",
        "repos_url": "https://api.github.com/users/fanquake/repos",
        "events_url": "https://api.github.com/users/fanquake/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/fanquake/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/gui/issues/768#issuecomment-1759877601",
      "issue_url": "https://api.github.com/repos/bitcoin-core/gui/issues/768"
    },
    {
      "event": "commented",
      "id": 1761462740,
      "node_id": "IC_kwDOEEET9c5o_cnU",
      "url": "https://api.github.com/repos/bitcoin-core/gui/issues/comments/1761462740",
      "actor": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-13T12:46:53Z",
      "updated_at": "2023-10-13T12:46:53Z",
      "author_association": "CONTRIBUTOR",
      "body": "This also appears to occur for me on v25.0, So not a regression on master. e.g. with the following graph:\r\n\r\n![image](https://github.com/bitcoin-core/gui/assets/6606587/250fa858-3930-4bae-8610-8e722ecb5c24)\r\n\r\nI see CPU thrashing of 50 - 90%, and get this similar-looking perf report: https://tmp.256k1.dev/23_10_bitcoin_qt_25.0_cpu.svg\r\n",
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/gui/issues/768#issuecomment-1761462740",
      "issue_url": "https://api.github.com/repos/bitcoin-core/gui/issues/768"
    },
    {
      "event": "commented",
      "id": 1764598054,
      "node_id": "IC_kwDOEEET9c5pLaEm",
      "url": "https://api.github.com/repos/bitcoin-core/gui/issues/comments/1764598054",
      "actor": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-16T14:25:18Z",
      "updated_at": "2023-10-16T14:25:18Z",
      "author_association": "CONTRIBUTOR",
      "body": "Which version of qt? Does it also happen with a previous release (statically compiled)?",
      "user": {
        "login": "maflcko",
        "id": 6399679,
        "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maflcko",
        "html_url": "https://github.com/maflcko",
        "followers_url": "https://api.github.com/users/maflcko/followers",
        "following_url": "https://api.github.com/users/maflcko/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/maflcko/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/maflcko/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/maflcko/subscriptions",
        "organizations_url": "https://api.github.com/users/maflcko/orgs",
        "repos_url": "https://api.github.com/users/maflcko/repos",
        "events_url": "https://api.github.com/users/maflcko/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/maflcko/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/gui/issues/768#issuecomment-1764598054",
      "issue_url": "https://api.github.com/repos/bitcoin-core/gui/issues/768"
    },
    {
      "event": "commented",
      "id": 1777161457,
      "node_id": "IC_kwDOEEET9c5p7VTx",
      "url": "https://api.github.com/repos/bitcoin-core/gui/issues/comments/1777161457",
      "actor": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-10-24T13:01:01Z",
      "updated_at": "2023-10-24T13:01:01Z",
      "author_association": "CONTRIBUTOR",
      "body": "Sorry for the slow reply, these were both compiled with libqt5gui5 version 5.15.8+dfsg-3.\r\n\r\nWhich previous release would you like me to try?",
      "user": {
        "login": "willcl-ark",
        "id": 6606587,
        "node_id": "MDQ6VXNlcjY2MDY1ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6606587?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/willcl-ark",
        "html_url": "https://github.com/willcl-ark",
        "followers_url": "https://api.github.com/users/willcl-ark/followers",
        "following_url": "https://api.github.com/users/willcl-ark/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/willcl-ark/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/willcl-ark/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/willcl-ark/subscriptions",
        "organizations_url": "https://api.github.com/users/willcl-ark/orgs",
        "repos_url": "https://api.github.com/users/willcl-ark/repos",
        "events_url": "https://api.github.com/users/willcl-ark/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/willcl-ark/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/gui/issues/768#issuecomment-1777161457",
      "issue_url": "https://api.github.com/repos/bitcoin-core/gui/issues/768"
    }
  ]
}