{
  "type": "issue",
  "issue": {
    "id": 811572485,
    "node_id": "MDU6SXNzdWU4MTE1NzI0ODU=",
    "url": "https://api.github.com/repos/bitcoin-core/gui/issues/212",
    "repository_url": "https://api.github.com/repos/bitcoin-core/gui",
    "labels_url": "https://api.github.com/repos/bitcoin-core/gui/issues/212/labels%7B/name%7D",
    "comments_url": "https://api.github.com/repos/bitcoin-core/gui/issues/212/comments",
    "events_url": "https://api.github.com/repos/bitcoin-core/gui/issues/212/events",
    "html_url": "https://github.com/bitcoin-core/gui/issues/212",
    "number": 212,
    "state": "open",
    "state_reason": null,
    "title": "Testnet configuration is ignored",
    "body": "Running `bitcoin-qt.exe -testnet` creates a separate testnet QSettings called `Bitcoin-Qt-testnet`. I assume this was done on purpose, so you can easily run testnet settings in parallel to mainnet.\r\n\r\n**Expected behavior**\r\n\r\nChanging settings in the `Bitcoin-Qt-testnet` QSettings should be reflected in the Qt wallet when running with `-testnet`.\r\n\r\nFor example, on Windows the QSettings are stored in the registry. The testnet key is here:\r\n\r\n![image](https://user-images.githubusercontent.com/78885860/107659308-4d685500-6c87-11eb-87b0-79e5e87b1653.png)\r\n\r\n**Actual behavior**\r\n\r\nThe `Bitcoin-Qt-testnet` settings are ignored, and `Bitcoin-Qt` mainnet settings are used in stead.\r\n\r\n**To reproduce**\r\n\r\nOn a clean system, start the wallet for the first time in `-testnet` mode. In the start wizard, change any option (e.g. the path). Observe how all defaults are written to `Bitcoin-Qt-testnet`, but the updated settings are written to the (previously empty) `Bitcoin-Qt` QSettings:\r\n\r\n![image](https://user-images.githubusercontent.com/78885860/107662270-6aeaee00-6c8a-11eb-893c-ddbab9798c99.png)\r\n\r\n**What is happening**\r\n\r\nIt appears as if during the initialization of the app (while writing default settings), the appName (and QSettings based on appName) is still `QAPP_APP_NAME_TESTNET`. Yet later (when reading the settings) the app name changed to `QAPP_APP_NAME_DEFAULT`.\r\n\r\n**What causes this**\r\n\r\nPerhaps because here the appName is set to `QAPP_APP_NAME_DEFAULT`:\r\nhttps://github.com/bitcoin/bitcoin/blob/8e1913ae025ad8912457abe24ae5c61da02fc17a/src/qt/bitcoin.cpp#L496-L501\r\n\r\nRather than the one from the test NetworkStyle:\r\nhttps://github.com/bitcoin/bitcoin/blob/8e1913ae025ad8912457abe24ae5c61da02fc17a/src/qt/networkstyle.cpp#L14-L24\r\n\r\nPerhaps it would work as intended if we would use the NetworkStyle app name. E.g.:\r\n\r\n```diff\r\n    /// 3. Application identification\r\n    // must be set before OptionsModel is initialized or translations are loaded,\r\n    // as it is used to locate QSettings\r\n    QApplication::setOrganizationName(QAPP_ORG_NAME);\r\n    QApplication::setOrganizationDomain(QAPP_ORG_DOMAIN);\r\n-    QApplication::setApplicationName(QAPP_APP_NAME_DEFAULT);\r\n+    QApplication::setApplicationName(networkStyle->getAppName());\r\n```\r\n\r\n**System information**\r\n\r\nWindows 10\r\nBitcoin 0.21 precompiled\r\n\r\n**Extra info**\r\n\r\nIt is possible that the intended behavior was never finished and forgotten, or it was never intended to work the way I am assuming.\r\n\r\nOriginally found on Syscoin here: https://github.com/syscoin/syscoin/issues/417",
    "user": {
      "login": "beirut-boop",
      "id": 78885860,
      "node_id": "MDQ6VXNlcjc4ODg1ODYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/78885860?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/beirut-boop",
      "html_url": "https://github.com/beirut-boop",
      "followers_url": "https://api.github.com/users/beirut-boop/followers",
      "following_url": "https://api.github.com/users/beirut-boop/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/beirut-boop/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/beirut-boop/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/beirut-boop/subscriptions",
      "organizations_url": "https://api.github.com/users/beirut-boop/orgs",
      "repos_url": "https://api.github.com/users/beirut-boop/repos",
      "events_url": "https://api.github.com/users/beirut-boop/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/beirut-boop/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 2140649117,
        "node_id": "MDU6TGFiZWwyMTQwNjQ5MTE3",
        "url": "https://api.github.com/repos/bitcoin-core/gui/labels/Bug",
        "name": "Bug",
        "description": "Something isn't working",
        "color": "d73a4a",
        "default": false
      }
    ],
    "assignees": [],
    "author_association": "NONE",
    "locked": false,
    "comments": 1,
    "created_at": "2021-02-19T00:11:41Z",
    "updated_at": "2021-02-19T15:55:22Z"
  },
  "events": [
    {
      "event": "labeled",
      "id": 4349560287,
      "node_id": "MDEyOkxhYmVsZWRFdmVudDQzNDk1NjAyODc=",
      "url": "https://api.github.com/repos/bitcoin-core/gui/issues/events/4349560287",
      "actor": {
        "login": "beirut-boop",
        "id": 78885860,
        "node_id": "MDQ6VXNlcjc4ODg1ODYw",
        "avatar_url": "https://avatars.githubusercontent.com/u/78885860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/beirut-boop",
        "html_url": "https://github.com/beirut-boop",
        "followers_url": "https://api.github.com/users/beirut-boop/followers",
        "following_url": "https://api.github.com/users/beirut-boop/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/beirut-boop/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/beirut-boop/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/beirut-boop/subscriptions",
        "organizations_url": "https://api.github.com/users/beirut-boop/orgs",
        "repos_url": "https://api.github.com/users/beirut-boop/repos",
        "events_url": "https://api.github.com/users/beirut-boop/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/beirut-boop/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-02-19T00:11:41Z",
      "label": {
        "name": "Bug",
        "color": "d73a4a"
      }
    },
    {
      "event": "commented",
      "id": 782164706,
      "node_id": "MDEyOklzc3VlQ29tbWVudDc4MjE2NDcwNg==",
      "url": "https://api.github.com/repos/bitcoin-core/gui/issues/comments/782164706",
      "actor": {
        "login": "jarolrod",
        "id": 23396902,
        "node_id": "MDQ6VXNlcjIzMzk2OTAy",
        "avatar_url": "https://avatars.githubusercontent.com/u/23396902?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jarolrod",
        "html_url": "https://github.com/jarolrod",
        "followers_url": "https://api.github.com/users/jarolrod/followers",
        "following_url": "https://api.github.com/users/jarolrod/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jarolrod/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jarolrod/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jarolrod/subscriptions",
        "organizations_url": "https://api.github.com/users/jarolrod/orgs",
        "repos_url": "https://api.github.com/users/jarolrod/repos",
        "events_url": "https://api.github.com/users/jarolrod/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jarolrod/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2021-02-19T15:55:21Z",
      "updated_at": "2021-02-19T15:55:21Z",
      "author_association": "MEMBER",
      "body": "Note: Related to https://github.com/bitcoin/bitcoin/issues/8106",
      "user": {
        "login": "jarolrod",
        "id": 23396902,
        "node_id": "MDQ6VXNlcjIzMzk2OTAy",
        "avatar_url": "https://avatars.githubusercontent.com/u/23396902?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jarolrod",
        "html_url": "https://github.com/jarolrod",
        "followers_url": "https://api.github.com/users/jarolrod/followers",
        "following_url": "https://api.github.com/users/jarolrod/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/jarolrod/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/jarolrod/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/jarolrod/subscriptions",
        "organizations_url": "https://api.github.com/users/jarolrod/orgs",
        "repos_url": "https://api.github.com/users/jarolrod/repos",
        "events_url": "https://api.github.com/users/jarolrod/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/jarolrod/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/gui/issues/212#issuecomment-782164706",
      "issue_url": "https://api.github.com/repos/bitcoin-core/gui/issues/212"
    }
  ]
}