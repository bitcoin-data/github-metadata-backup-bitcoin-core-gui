{
  "type": "pull",
  "pull": {
    "url": "https://api.github.com/repos/bitcoin-core/gui/pulls/751",
    "id": 1508011623,
    "node_id": "PR_kwDOEEET9c5Z4m5n",
    "html_url": "https://github.com/bitcoin-core/gui/pull/751",
    "diff_url": "https://github.com/bitcoin-core/gui/pull/751.diff",
    "patch_url": "https://github.com/bitcoin-core/gui/pull/751.patch",
    "issue_url": "https://api.github.com/repos/bitcoin-core/gui/issues/751",
    "commits_url": "https://api.github.com/repos/bitcoin-core/gui/pulls/751/commits",
    "review_comments_url": "https://api.github.com/repos/bitcoin-core/gui/pulls/751/comments",
    "review_comment_url": "https://api.github.com/repos/bitcoin-core/gui/pulls/comments%7B/number%7D",
    "comments_url": "https://api.github.com/repos/bitcoin-core/gui/issues/751/comments",
    "statuses_url": "https://api.github.com/repos/bitcoin-core/gui/statuses/c08fe9992b56be5e60b613f656bc945322452987",
    "number": 751,
    "state": "open",
    "locked": false,
    "maintainer_can_modify": true,
    "title": "gui: macOS, do not process actions during shutdown",
    "user": {
      "login": "furszy",
      "id": 5377650,
      "node_id": "MDQ6VXNlcjUzNzc2NTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/furszy",
      "html_url": "https://github.com/furszy",
      "followers_url": "https://api.github.com/users/furszy/followers",
      "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
      "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
      "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
      "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
      "organizations_url": "https://api.github.com/users/furszy/orgs",
      "repos_url": "https://api.github.com/users/furszy/repos",
      "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
      "received_events_url": "https://api.github.com/users/furszy/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "As the 'QMenuBar' is created without a parent window in MacOS, the app crashes when the user presses the shutdown button and, right after it, triggers any action in the menu bar.\r\n\r\nThis happens because the QMenuBar is manually deleted in the BitcoinGUI destructor but the events attached to it children actions are not disconnected, so QActions events such us the 'QMenu::aboutToShow' could try to access null pointers.\r\n\r\nInstead of guarding every single QAction pointer inside the QMenu::aboutToShow slot, or manually disconnecting all registered events in the destructor, we can check if a shutdown was requested and discard the event.\r\n\r\nThe 'node' field is a ref whose memory is held by the main application class, so it is safe to use here. Events are disconnected prior destructing the main application object.\r\n\r\nFurthermore, the 'MacDockIconHandler::dockIconClicked' signal can make the app crash during shutdown for the very same reason. The 'show()' call triggers the 'QApplication::focusWindowChanged' event, which is connected to the 'minimize_action' QAction, which is also part of the app menu bar, which could no longer exist.\r\n\r\nImportant Note:\r\nThis happened to me few times. The worst consequence was an inconsistent chain state during IBD. Which triggered a full \"replay blocks\" process on the next startup. Which was painfully slow.",
    "labels": [],
    "created_at": "2023-09-08T14:34:56Z",
    "updated_at": "2023-09-12T14:26:23Z",
    "mergeable": true,
    "mergeable_state": "unstable",
    "merge_commit_sha": "d01874cbfd96355baa35ca20f4387e9f00cb4406",
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "rebaseable": true,
    "head": {
      "label": "furszy:2023_gui_fix_appbar_crash",
      "ref": "2023_gui_fix_appbar_crash",
      "sha": "c08fe9992b56be5e60b613f656bc945322452987",
      "user": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "repo": {
        "id": 490320067,
        "node_id": "R_kgDOHTmwww",
        "name": "bitcoin-gui",
        "full_name": "furszy/bitcoin-gui",
        "owner": {
          "login": "furszy",
          "id": 5377650,
          "node_id": "MDQ6VXNlcjUzNzc2NTA=",
          "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/furszy",
          "html_url": "https://github.com/furszy",
          "followers_url": "https://api.github.com/users/furszy/followers",
          "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
          "organizations_url": "https://api.github.com/users/furszy/orgs",
          "repos_url": "https://api.github.com/users/furszy/repos",
          "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/furszy/received_events",
          "type": "User",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/furszy/bitcoin-gui",
        "description": "Bitcoin Core GUI staging repository",
        "fork": true,
        "url": "https://api.github.com/repos/furszy/bitcoin-gui",
        "archive_url": "https://api.github.com/repos/furszy/bitcoin-gui/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/furszy/bitcoin-gui/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/furszy/bitcoin-gui/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/furszy/bitcoin-gui/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/furszy/bitcoin-gui/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/furszy/bitcoin-gui/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/furszy/bitcoin-gui/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/furszy/bitcoin-gui/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/furszy/bitcoin-gui/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/furszy/bitcoin-gui/contributors",
        "deployments_url": "https://api.github.com/repos/furszy/bitcoin-gui/deployments",
        "downloads_url": "https://api.github.com/repos/furszy/bitcoin-gui/downloads",
        "events_url": "https://api.github.com/repos/furszy/bitcoin-gui/events",
        "forks_url": "https://api.github.com/repos/furszy/bitcoin-gui/forks",
        "git_commits_url": "https://api.github.com/repos/furszy/bitcoin-gui/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/furszy/bitcoin-gui/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/furszy/bitcoin-gui/git/tags%7B/sha%7D",
        "git_url": "git://github.com/furszy/bitcoin-gui.git",
        "issue_comment_url": "https://api.github.com/repos/furszy/bitcoin-gui/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/furszy/bitcoin-gui/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/furszy/bitcoin-gui/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/furszy/bitcoin-gui/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/furszy/bitcoin-gui/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/furszy/bitcoin-gui/languages",
        "merges_url": "https://api.github.com/repos/furszy/bitcoin-gui/merges",
        "milestones_url": "https://api.github.com/repos/furszy/bitcoin-gui/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/furszy/bitcoin-gui/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/furszy/bitcoin-gui/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/furszy/bitcoin-gui/releases%7B/id%7D",
        "ssh_url": "git@github.com:furszy/bitcoin-gui.git",
        "stargazers_url": "https://api.github.com/repos/furszy/bitcoin-gui/stargazers",
        "statuses_url": "https://api.github.com/repos/furszy/bitcoin-gui/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/furszy/bitcoin-gui/subscribers",
        "subscription_url": "https://api.github.com/repos/furszy/bitcoin-gui/subscription",
        "tags_url": "https://api.github.com/repos/furszy/bitcoin-gui/tags",
        "teams_url": "https://api.github.com/repos/furszy/bitcoin-gui/teams",
        "trees_url": "https://api.github.com/repos/furszy/bitcoin-gui/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/furszy/bitcoin-gui.git",
        "hooks_url": "https://api.github.com/repos/furszy/bitcoin-gui/hooks",
        "svn_url": "https://github.com/furszy/bitcoin-gui",
        "homepage": "https://github.com/bitcoin/bitcoin",
        "language": "C++",
        "forks_count": 0,
        "stargazers_count": 0,
        "watchers_count": 0,
        "size": 151129,
        "default_branch": "master",
        "open_issues_count": 0,
        "is_template": false,
        "topics": [],
        "has_issues": false,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-09-12T14:26:20Z",
        "created_at": "2022-05-09T14:34:00Z",
        "updated_at": "2023-09-08T14:09:02Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "base": {
      "label": "bitcoin-core:master",
      "ref": "master",
      "sha": "7649431637441d0e236f33d67eb196bfc33a13a7",
      "user": {
        "login": "bitcoin-core",
        "id": 13464320,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjEzNDY0MzIw",
        "avatar_url": "https://avatars.githubusercontent.com/u/13464320?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin-core",
        "html_url": "https://github.com/bitcoin-core",
        "followers_url": "https://api.github.com/users/bitcoin-core/followers",
        "following_url": "https://api.github.com/users/bitcoin-core/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/bitcoin-core/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/bitcoin-core/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/bitcoin-core/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin-core/orgs",
        "repos_url": "https://api.github.com/users/bitcoin-core/repos",
        "events_url": "https://api.github.com/users/bitcoin-core/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/bitcoin-core/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "repo": {
        "id": 272700405,
        "node_id": "MDEwOlJlcG9zaXRvcnkyNzI3MDA0MDU=",
        "name": "gui",
        "full_name": "bitcoin-core/gui",
        "owner": {
          "login": "bitcoin-core",
          "id": 13464320,
          "node_id": "MDEyOk9yZ2FuaXphdGlvbjEzNDY0MzIw",
          "avatar_url": "https://avatars.githubusercontent.com/u/13464320?v=4",
          "gravatar_id": "",
          "url": "https://api.github.com/users/bitcoin-core",
          "html_url": "https://github.com/bitcoin-core",
          "followers_url": "https://api.github.com/users/bitcoin-core/followers",
          "following_url": "https://api.github.com/users/bitcoin-core/following%7B/other_user%7D",
          "gists_url": "https://api.github.com/users/bitcoin-core/gists%7B/gist_id%7D",
          "starred_url": "https://api.github.com/users/bitcoin-core/starred%7B/owner%7D%7B/repo%7D",
          "subscriptions_url": "https://api.github.com/users/bitcoin-core/subscriptions",
          "organizations_url": "https://api.github.com/users/bitcoin-core/orgs",
          "repos_url": "https://api.github.com/users/bitcoin-core/repos",
          "events_url": "https://api.github.com/users/bitcoin-core/events%7B/privacy%7D",
          "received_events_url": "https://api.github.com/users/bitcoin-core/received_events",
          "type": "Organization",
          "site_admin": false
        },
        "private": false,
        "html_url": "https://github.com/bitcoin-core/gui",
        "description": "Bitcoin Core GUI staging repository",
        "fork": false,
        "url": "https://api.github.com/repos/bitcoin-core/gui",
        "archive_url": "https://api.github.com/repos/bitcoin-core/gui/%7Barchive_format%7D%7B/ref%7D",
        "assignees_url": "https://api.github.com/repos/bitcoin-core/gui/assignees%7B/user%7D",
        "blobs_url": "https://api.github.com/repos/bitcoin-core/gui/git/blobs%7B/sha%7D",
        "branches_url": "https://api.github.com/repos/bitcoin-core/gui/branches%7B/branch%7D",
        "collaborators_url": "https://api.github.com/repos/bitcoin-core/gui/collaborators%7B/collaborator%7D",
        "comments_url": "https://api.github.com/repos/bitcoin-core/gui/comments%7B/number%7D",
        "commits_url": "https://api.github.com/repos/bitcoin-core/gui/commits%7B/sha%7D",
        "compare_url": "https://api.github.com/repos/bitcoin-core/gui/compare/%7Bbase%7D...%7Bhead%7D",
        "contents_url": "https://api.github.com/repos/bitcoin-core/gui/contents/%7B+path%7D",
        "contributors_url": "https://api.github.com/repos/bitcoin-core/gui/contributors",
        "deployments_url": "https://api.github.com/repos/bitcoin-core/gui/deployments",
        "downloads_url": "https://api.github.com/repos/bitcoin-core/gui/downloads",
        "events_url": "https://api.github.com/repos/bitcoin-core/gui/events",
        "forks_url": "https://api.github.com/repos/bitcoin-core/gui/forks",
        "git_commits_url": "https://api.github.com/repos/bitcoin-core/gui/git/commits%7B/sha%7D",
        "git_refs_url": "https://api.github.com/repos/bitcoin-core/gui/git/refs%7B/sha%7D",
        "git_tags_url": "https://api.github.com/repos/bitcoin-core/gui/git/tags%7B/sha%7D",
        "git_url": "git://github.com/bitcoin-core/gui.git",
        "issue_comment_url": "https://api.github.com/repos/bitcoin-core/gui/issues/comments%7B/number%7D",
        "issue_events_url": "https://api.github.com/repos/bitcoin-core/gui/issues/events%7B/number%7D",
        "issues_url": "https://api.github.com/repos/bitcoin-core/gui/issues%7B/number%7D",
        "keys_url": "https://api.github.com/repos/bitcoin-core/gui/keys%7B/key_id%7D",
        "labels_url": "https://api.github.com/repos/bitcoin-core/gui/labels%7B/name%7D",
        "languages_url": "https://api.github.com/repos/bitcoin-core/gui/languages",
        "merges_url": "https://api.github.com/repos/bitcoin-core/gui/merges",
        "milestones_url": "https://api.github.com/repos/bitcoin-core/gui/milestones%7B/number%7D",
        "notifications_url": "https://api.github.com/repos/bitcoin-core/gui/notifications%7B?since,all,participating}",
        "pulls_url": "https://api.github.com/repos/bitcoin-core/gui/pulls%7B/number%7D",
        "releases_url": "https://api.github.com/repos/bitcoin-core/gui/releases%7B/id%7D",
        "ssh_url": "git@github.com:bitcoin-core/gui.git",
        "stargazers_url": "https://api.github.com/repos/bitcoin-core/gui/stargazers",
        "statuses_url": "https://api.github.com/repos/bitcoin-core/gui/statuses/%7Bsha%7D",
        "subscribers_url": "https://api.github.com/repos/bitcoin-core/gui/subscribers",
        "subscription_url": "https://api.github.com/repos/bitcoin-core/gui/subscription",
        "tags_url": "https://api.github.com/repos/bitcoin-core/gui/tags",
        "teams_url": "https://api.github.com/repos/bitcoin-core/gui/teams",
        "trees_url": "https://api.github.com/repos/bitcoin-core/gui/git/trees%7B/sha%7D",
        "clone_url": "https://github.com/bitcoin-core/gui.git",
        "hooks_url": "https://api.github.com/repos/bitcoin-core/gui/hooks",
        "svn_url": "https://github.com/bitcoin-core/gui",
        "homepage": "https://github.com/bitcoin/bitcoin",
        "language": "C++",
        "forks_count": 277,
        "stargazers_count": 508,
        "watchers_count": 508,
        "size": 151870,
        "default_branch": "master",
        "open_issues_count": 161,
        "is_template": false,
        "topics": [],
        "has_issues": true,
        "has_projects": true,
        "has_wiki": false,
        "has_pages": false,
        "has_downloads": true,
        "archived": false,
        "disabled": false,
        "visibility": "public",
        "pushed_at": "2023-09-12T14:26:23Z",
        "created_at": "2020-06-16T12:20:07Z",
        "updated_at": "2023-09-12T12:06:40Z",
        "license": {
          "key": "mit",
          "name": "MIT License",
          "node_id": "MDc6TGljZW5zZTEz",
          "spdx_id": "MIT",
          "url": "https://api.github.com/licenses/mit",
          "html_url": null,
          "description": null,
          "implementation": null,
          "permissions": null,
          "conditions": null,
          "limitations": null,
          "body": null,
          "featured": null
        }
      }
    },
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin-core/gui/pulls/751"
      }
    },
    "author_association": "CONTRIBUTOR",
    "draft": false,
    "additions": 3,
    "deletions": 6,
    "changed_files": 1,
    "commits": 2,
    "review_comments": 0,
    "comments": 1
  },
  "events": [
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOEEET9doAKGUxNGNjOGZjNjljYjNlM2E5ODA3NmZiYjIzYTk0ZWJhNzg3MzM2OGE",
      "url": "https://api.github.com/repos/bitcoin-core/gui/git/commits/e14cc8fc69cb3e3a98076fbb23a94eba7873368a",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/gui/commit/e14cc8fc69cb3e3a98076fbb23a94eba7873368a",
      "tree": {
        "sha": "84bf136374ccf5e5b944ff83d1f368f7f4d03bc7",
        "url": "https://api.github.com/repos/bitcoin-core/gui/git/trees/84bf136374ccf5e5b944ff83d1f368f7f4d03bc7"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 84bf136374ccf5e5b944ff83d1f368f7f4d03bc7\nparent 238d29aff9b43234e340a9cf17742b2be5d1e97d\nauthor furszy <matiasfurszyfer@protonmail.com> 1694181517 -0300\ncommitter furszy <matiasfurszyfer@protonmail.com> 1694183632 -0300\n\ngui: macOS, do not process dock icon actions during shutdown\n\nAs the 'QMenuBar' is created without a parent window in MacOS, the\napp crashes when the user presses the shutdown button and, right\nafter it, triggers any action in the menu bar.\n\nThis happens because the QMenuBar is manually deleted in the\nBitcoinGUI destructor but the events attached to it children\nactions are not disconnected, so QActions events such us the\n'QMenu::aboutToShow' could try to access null pointers.\n\nInstead of guarding every single QAction pointer inside the\nQMenu::aboutToShow slot, or manually disconnecting all\nregistered events in the destructor, we can check if a\nshutdown was requested and discard the event.\n\nThe 'node' field is a ref whose memory is held by the\nmain application class, so it is safe to use here. Events\nare disconnected prior destructing the main application object.\n\nFurthermore, the 'MacDockIconHandler::dockIconClicked' signal\ncan make the app crash during shutdown for the very same\nreason. The 'show()' call triggers the 'QApplication::focusWindowChanged'\nevent, which is connected to the 'minimize_action' QAction,\nwhich is also part of the app menu bar, which could no longer exist.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEA++0fqwRHQpmlZfQXdI8zGhqpiMFAmT7MNAACgkQXdI8zGhq\npiNlkQ/+LMoP9CrlzyWZyyuvsA3CqzaBnamFxMjdT3NWZdEzGTBJtBCGaHsQdy/n\naTCEiLKRN8dpW69TNO94lEYNLs1TkQiBaCugYZn6ZIQBUVDiPv+rri4Iihloqi6O\nzZOk3bg3Zf1G1TcR+4+kNhoP92zpSklib3l/i/RmUzhkGKaiAcT6pOsJLYPnc/Kz\n6YOLVR3DHtRc6ML1BdPitm+AXZR6tNdrhTIwe3YYSbbcoXin8WZkPyqOEMqkUCqL\n4pbb/0N8j9dMrYCkq0Et/X8fohkm8TiMXCBCn10b9v6dAxJXJic4wUmHsLfs5aa0\nVnOTNA+rkaS0v2k8UdfIchinCcK4VKALcWx0ar5SasgdawADq3jz/XnMT3+jimHM\nwB0ctXDkPsflMOG10uh08JoBP0ENjDApDwqq1UmLbOfcSHRce5omVQF1uYnHKVJm\n7Rr8wvEM3MJtzFUAz24a8G09ZiUaSFlZVu/uliXERajJJJMlEKS5/wwDJZAs1E/z\nbIYr5ZeEdvHNN69JyHvTn0dlWdMQwp11fS6/LoezyDoWQZWywUDrwpkONGRegcWP\nmPtLReIUwXZOJUXc1Zl17z9puWbIDmWuXg/2qC/IbOIOUvGrvem2N2fZEihNCyYT\nHqWVaPO4ZzLzCgC2ai7R+CHoW2+j0JYFEAbNwbvwfP2m3w40QpE=\n=cyfm\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/gui/git/commits/238d29aff9b43234e340a9cf17742b2be5d1e97d",
          "sha": "238d29aff9b43234e340a9cf17742b2be5d1e97d",
          "html_url": "https://github.com/bitcoin-core/gui/commit/238d29aff9b43234e340a9cf17742b2be5d1e97d"
        }
      ],
      "message": "gui: macOS, do not process dock icon actions during shutdown\n\nAs the 'QMenuBar' is created without a parent window in MacOS, the\napp crashes when the user presses the shutdown button and, right\nafter it, triggers any action in the menu bar.\n\nThis happens because the QMenuBar is manually deleted in the\nBitcoinGUI destructor but the events attached to it children\nactions are not disconnected, so QActions events such us the\n'QMenu::aboutToShow' could try to access null pointers.\n\nInstead of guarding every single QAction pointer inside the\nQMenu::aboutToShow slot, or manually disconnecting all\nregistered events in the destructor, we can check if a\nshutdown was requested and discard the event.\n\nThe 'node' field is a ref whose memory is held by the\nmain application class, so it is safe to use here. Events\nare disconnected prior destructing the main application object.\n\nFurthermore, the 'MacDockIconHandler::dockIconClicked' signal\ncan make the app crash during shutdown for the very same\nreason. The 'show()' call triggers the 'QApplication::focusWindowChanged'\nevent, which is connected to the 'minimize_action' QAction,\nwhich is also part of the app menu bar, which could no longer exist.",
      "committer": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2023-09-08T14:33:52Z"
      },
      "author": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2023-09-08T13:58:37Z"
      },
      "sha": "e14cc8fc69cb3e3a98076fbb23a94eba7873368a"
    },
    {
      "event": "commented",
      "id": 1711774101,
      "node_id": "IC_kwDOEEET9c5mB5mV",
      "url": "https://api.github.com/repos/bitcoin-core/gui/issues/comments/1711774101",
      "actor": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-08T14:34:59Z",
      "updated_at": "2023-09-08T20:30:05Z",
      "author_association": "CONTRIBUTOR",
      "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Approach ACK | [hernanmarino](https://github.com/bitcoin-core/gui/pull/751#pullrequestreview-1618218071) |\n\nIf your review is incorrectly listed, please react with ðŸ‘Ž to this comment and the bot will ignore it on the next update.\n",
      "user": {
        "login": "DrahtBot",
        "id": 39886733,
        "node_id": "MDQ6VXNlcjM5ODg2NzMz",
        "avatar_url": "https://avatars.githubusercontent.com/u/39886733?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DrahtBot",
        "html_url": "https://github.com/DrahtBot",
        "followers_url": "https://api.github.com/users/DrahtBot/followers",
        "following_url": "https://api.github.com/users/DrahtBot/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/DrahtBot/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/DrahtBot/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
        "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
        "repos_url": "https://api.github.com/users/DrahtBot/repos",
        "events_url": "https://api.github.com/users/DrahtBot/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/gui/pull/751#issuecomment-1711774101",
      "issue_url": "https://api.github.com/repos/bitcoin-core/gui/issues/751"
    },
    {
      "event": "renamed",
      "id": 10319093970,
      "node_id": "RTE_lADOEEET9c5wha2_zwAAAAJnEODS",
      "url": "https://api.github.com/repos/bitcoin-core/gui/issues/events/10319093970",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-08T14:43:54Z",
      "rename": {
        "from": "gui: macOS, do not process dock icon actions during shutdown",
        "to": "gui: macOS, do not process actions during shutdown"
      }
    },
    {
      "event": "reviewed",
      "id": 1618218071,
      "node_id": "PRR_kwDOEEET9c5gdAxX",
      "url": null,
      "actor": null,
      "commit_id": "e14cc8fc69cb3e3a98076fbb23a94eba7873368a",
      "commit_url": null,
      "created_at": null,
      "author_association": "CONTRIBUTOR",
      "body": "Approach ACK . I cannot test this (not my OS) but changes seem straightforward",
      "user": {
        "login": "hernanmarino",
        "id": 87907936,
        "node_id": "MDQ6VXNlcjg3OTA3OTM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/87907936?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hernanmarino",
        "html_url": "https://github.com/hernanmarino",
        "followers_url": "https://api.github.com/users/hernanmarino/followers",
        "following_url": "https://api.github.com/users/hernanmarino/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/hernanmarino/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/hernanmarino/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/hernanmarino/subscriptions",
        "organizations_url": "https://api.github.com/users/hernanmarino/orgs",
        "repos_url": "https://api.github.com/users/hernanmarino/repos",
        "events_url": "https://api.github.com/users/hernanmarino/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/hernanmarino/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin-core/gui/pull/751#pullrequestreview-1618218071",
      "submitted_at": "2023-09-08T20:30:03Z",
      "state": "APPROVED",
      "pull_request_url": "https://api.github.com/repos/bitcoin-core/gui/pulls/751"
    },
    {
      "event": "committed",
      "id": null,
      "node_id": "C_kwDOEEET9doAKGMwOGZlOTk5MmI1NmJlNWU2MGI2MTNmNjU2YmM5NDUzMjI0NTI5ODc",
      "url": "https://api.github.com/repos/bitcoin-core/gui/git/commits/c08fe9992b56be5e60b613f656bc945322452987",
      "actor": null,
      "commit_id": null,
      "commit_url": null,
      "created_at": null,
      "html_url": "https://github.com/bitcoin-core/gui/commit/c08fe9992b56be5e60b613f656bc945322452987",
      "tree": {
        "sha": "40cf593cefa9f345f6886116cb9548a6eb41aac8",
        "url": "https://api.github.com/repos/bitcoin-core/gui/git/trees/40cf593cefa9f345f6886116cb9548a6eb41aac8"
      },
      "verification": {
        "verified": true,
        "reason": "valid",
        "payload": "tree 40cf593cefa9f345f6886116cb9548a6eb41aac8\nparent e14cc8fc69cb3e3a98076fbb23a94eba7873368a\nauthor furszy <matiasfurszyfer@protonmail.com> 1694528141 -0300\ncommitter furszy <matiasfurszyfer@protonmail.com> 1694528763 -0300\n\ngui: macOS, make appMenuBar part of the main app window\n\nBy moving the appMenuBar destruction responsibility to the QT\nframework, we ensure the disconnection of the submenus signals\nprior to the destruction of the main app window.\n\nThe standalone menu bar may have served a purpose in earlier\nversions when it didn't contain actions that directly open\nspecific screens within the main application window. However,\nat present, all the actions within the appMenuBar lead to the\nopening of screens within the main app window. So, the absence\nof a main app window makes these actions essentially pointless.\n",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEA++0fqwRHQpmlZfQXdI8zGhqpiMFAmUAdPsACgkQXdI8zGhq\npiOI8Q/9H1uDUkZ7vQyRn53kSC0+3DIhlO/l9EAIRGINDVqLZ6agbpYMatkYjylR\nMVNbj8+J4wT4Ec7GVT99GL0tV/srsRZ8v2at11V6aaFCqkem3YGDUp3evP3MC9fF\n0Ugc4mbavxKtdAN9Z2B0zA1d1MwE8JISu3X1NduH/fFKTrznMSTGnHIspTQ1rk8M\n9FnN9r/3tisqxIKwJBOh9cEt64m2cK+lAtfcAHUMv+CRjmPwefCumr99n//CLSE9\nGsdk50E6xHyhU7a0fOWNmgSP1SykbYX5jnOQFxxPkPujM4fvQnciVL2VyvhGjzcd\nFUfRY2sU9It0PajupkY4OialxZ057XF4ek0QVCm6BhDjgBhkD6c35SEBWTC+OJbm\noUctXFjgEAZLbGxPQLRraAbHneWLxssRAeLpg9shFBm2muHhs2OyelIwBZMbgskd\nPI0Mvbq0/40OglRqqLK08TrxMCplLO0OyUIJwjegkUOdELxaU3XNpzGCK5aR12+3\nPf5Z7d9DZPnZP28I7RVas15JMUqsh5b1sBu7kitasx2HmgEixsRI5DmwHoFVrslz\nYmwccvZ2/UUKCa8ieDEKt+XPEMsrHxqU8aur+CLqz6+4FCKHcBgdaOk/CS93J3Yl\nJfnKZsRggIT59nK5yMfx7uSkpFuVip9UeE9lo4yQMlQMb1Xo60I=\n=XVKD\n-----END PGP SIGNATURE-----"
      },
      "parents": [
        {
          "url": "https://api.github.com/repos/bitcoin-core/gui/git/commits/e14cc8fc69cb3e3a98076fbb23a94eba7873368a",
          "sha": "e14cc8fc69cb3e3a98076fbb23a94eba7873368a",
          "html_url": "https://github.com/bitcoin-core/gui/commit/e14cc8fc69cb3e3a98076fbb23a94eba7873368a"
        }
      ],
      "message": "gui: macOS, make appMenuBar part of the main app window\n\nBy moving the appMenuBar destruction responsibility to the QT\nframework, we ensure the disconnection of the submenus signals\nprior to the destruction of the main app window.\n\nThe standalone menu bar may have served a purpose in earlier\nversions when it didn't contain actions that directly open\nspecific screens within the main application window. However,\nat present, all the actions within the appMenuBar lead to the\nopening of screens within the main app window. So, the absence\nof a main app window makes these actions essentially pointless.",
      "committer": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2023-09-12T14:26:03Z"
      },
      "author": {
        "name": "furszy",
        "email": "matiasfurszyfer@protonmail.com",
        "date": "2023-09-12T14:15:41Z"
      },
      "sha": "c08fe9992b56be5e60b613f656bc945322452987"
    },
    {
      "event": "head_ref_force_pushed",
      "id": 10347685490,
      "node_id": "HRFPE_lADOEEET9c5wha2_zwAAAAJoxSZy",
      "url": "https://api.github.com/repos/bitcoin-core/gui/issues/events/10347685490",
      "actor": {
        "login": "furszy",
        "id": 5377650,
        "node_id": "MDQ6VXNlcjUzNzc2NTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5377650?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/furszy",
        "html_url": "https://github.com/furszy",
        "followers_url": "https://api.github.com/users/furszy/followers",
        "following_url": "https://api.github.com/users/furszy/following%7B/other_user%7D",
        "gists_url": "https://api.github.com/users/furszy/gists%7B/gist_id%7D",
        "starred_url": "https://api.github.com/users/furszy/starred%7B/owner%7D%7B/repo%7D",
        "subscriptions_url": "https://api.github.com/users/furszy/subscriptions",
        "organizations_url": "https://api.github.com/users/furszy/orgs",
        "repos_url": "https://api.github.com/users/furszy/repos",
        "events_url": "https://api.github.com/users/furszy/events%7B/privacy%7D",
        "received_events_url": "https://api.github.com/users/furszy/received_events",
        "type": "User",
        "site_admin": false
      },
      "commit_id": null,
      "commit_url": null,
      "created_at": "2023-09-12T14:26:23Z"
    }
  ],
  "comments": []
}